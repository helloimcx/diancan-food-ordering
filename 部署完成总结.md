# âœ… é˜¿é‡Œäº‘Dockerè‡ªåŠ¨åŒ–éƒ¨ç½²é…ç½®å®Œæˆ

## ğŸ¯ é…ç½®çŠ¶æ€

### âœ… å·²å®Œæˆ
- [x] **Dockerfileåˆ›å»º** - server/Dockerfile
- [x] **GitHub Actionså·¥ä½œæµ** - .github/workflows/deploy-alicloud.yml  
- [x] **æœåŠ¡å™¨åˆå§‹åŒ–è„šæœ¬** - server-setup.sh
- [x] **SSHå¯†é’¥ç”Ÿæˆå·¥å…·** - generate-ssh-key.sh
- [x] **æœåŠ¡ç®¡ç†è„šæœ¬** - è‡ªåŠ¨åˆ›å»ºåœ¨æœåŠ¡å™¨ä¸Š
- [x] **å®Œæ•´éƒ¨ç½²æ–‡æ¡£** - é˜¿é‡Œäº‘å¿«é€Ÿéƒ¨ç½².md
- [x] **ä»£ç å·²æ¨é€åˆ°GitHub** - commit: 7165095

### ğŸš€ è‡ªåŠ¨åŒ–æµç¨‹
```
GitHub Push â†’ GitHub Actions â†’ æ„å»ºDockeré•œåƒ â†’ æ¨é€åˆ°GitHub Container Registry â†’ SSHåˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨ â†’ æ‹‰å–é•œåƒå¹¶å¯åŠ¨å®¹å™¨
```

## ğŸ“‹ ä¸‹ä¸€æ­¥æ“ä½œ

### ç¬¬ä¸€æ­¥: ç”ŸæˆSSHå¯†é’¥ (2åˆ†é’Ÿ)
```bash
./generate-ssh-key.sh
```
ğŸ“ **å¤åˆ¶æ˜¾ç¤ºçš„ç§é’¥å†…å®¹**

### ç¬¬äºŒæ­¥: é…ç½®é˜¿é‡Œäº‘æœåŠ¡å™¨ (10åˆ†é’Ÿ)
```bash
# ä¸Šä¼ è„šæœ¬
scp server-setup.sh root@YOUR_SERVER_IP:/root/

# ç™»å½•å¹¶åˆå§‹åŒ–
ssh root@YOUR_SERVER_IP
chmod +x server-setup.sh
./server-setup.sh
```

### ç¬¬ä¸‰æ­¥: è®¾ç½®GitHub Secrets (3åˆ†é’Ÿ)
åœ¨GitHubä»“åº“ `Settings` â†’ `Secrets` â†’ `New repository secret` ä¸­æ·»åŠ ï¼š

| åç§° | å€¼ |
|------|-----|
| ALICLOUD_HOST | YOUR_SERVER_IP |
| ALICLOUD_USER | root |
| ALICLOUD_PRIVATE_KEY | [ä»æ­¥éª¤1å¤åˆ¶çš„ç§é’¥å†…å®¹] |
| ALICLOUD_PORT | 22 |

### ç¬¬å››æ­¥: é…ç½®é˜¿é‡Œäº‘å®‰å…¨ç»„ (5åˆ†é’Ÿ)
åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°ä¸ºECSå®ä¾‹å®‰å…¨ç»„æ·»åŠ ç«¯å£ï¼š
- **3001** (TCP) - APIæœåŠ¡
- **22** (TCP) - SSH

### ç¬¬äº”æ­¥: æµ‹è¯•è‡ªåŠ¨éƒ¨ç½² (10åˆ†é’Ÿ)
```bash
git add server/
git commit -m "æµ‹è¯•é˜¿é‡Œäº‘Dockerè‡ªåŠ¨åŒ–éƒ¨ç½²"
git push origin main
```

## ğŸ› ï¸ ç³»ç»Ÿæ¶æ„

### GitHubä»“åº“
```
â”œâ”€â”€ .github/workflows/deploy-alicloud.yml  # CI/CDå·¥ä½œæµ
â”œâ”€â”€ server/Dockerfile                     # Dockeré•œåƒé…ç½®
â”œâ”€â”€ server-setup.sh                       # æœåŠ¡å™¨åˆå§‹åŒ–
â””â”€â”€ generate-ssh-key.sh                   # SSHå¯†é’¥ç”Ÿæˆ
```

### é˜¿é‡Œäº‘æœåŠ¡å™¨ (/opt/diancan-backend/)
```
â”œâ”€â”€ docker-compose.yml      # å®¹å™¨ç¼–æ’é…ç½®
â”œâ”€â”€ deploy.sh               # è‡ªåŠ¨éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ service-manager.sh      # æœåŠ¡ç®¡ç†
â”œâ”€â”€ health-check.sh         # å¥åº·æ£€æŸ¥
â”œâ”€â”€ cleanup.sh              # æ¸…ç†è„šæœ¬
â””â”€â”€ data/                   # æ•°æ®åº“æ–‡ä»¶
```

## ğŸŒ éƒ¨ç½²å®Œæˆå

### APIåœ°å€
```
http://YOUR_SERVER_IP:3001/api
```

### å‰ç«¯é…ç½®
åœ¨Vercelé¡¹ç›®ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ï¼š
```
VITE_API_URL=http://YOUR_SERVER_IP:3001/api
```

### è®¿é—®åº”ç”¨
- **å‰ç«¯**: https://diancan-food-ordering.vercel.app
- **åç«¯**: http://YOUR_SERVER_IP:3001/api

## ğŸ“Š ç®¡ç†å‘½ä»¤

### æœåŠ¡å™¨ç®¡ç†
```bash
cd /opt/diancan-backend

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./service-manager.sh status

# æŸ¥çœ‹æ—¥å¿—
./service-manager.sh logs

# é‡å¯æœåŠ¡
./service-manager.sh restart

# ç¯å¢ƒæ£€æŸ¥
./health-check.sh
```

## ğŸ”’ å®‰å…¨ç‰¹æ€§

1. **SSHå¯†é’¥è®¤è¯** - æ— éœ€å¯†ç ç™»å½•
2. **GitHub Secrets** - æ•æ„Ÿä¿¡æ¯å®‰å…¨ç®¡ç†
3. **Dockerå®¹å™¨éš”ç¦»** - å®‰å…¨æ€§å¢å¼º
4. **å¥åº·æ£€æŸ¥** - è‡ªåŠ¨æ•…éšœæ£€æµ‹
5. **æ—¥å¿—ç›‘æ§** - éƒ¨ç½²çŠ¶æ€é€æ˜

## ğŸ‰ ä¼˜åŠ¿

- âœ… **å®Œå…¨è‡ªåŠ¨åŒ–** - æ¨é€ä»£ç å³å¯éƒ¨ç½²
- âœ… **ç‰ˆæœ¬æ§åˆ¶** - æ¯æ¬¡éƒ¨ç½²éƒ½æœ‰è®°å½•
- âœ… **å¿«é€Ÿå›æ»š** - å¯å¿«é€Ÿæ¢å¤ä¹‹å‰ç‰ˆæœ¬
- âœ… **å¤šç¯å¢ƒæ”¯æŒ** - å®¹æ˜“æ‰©å±•åˆ°æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒ
- âœ… **é›¶åœæœºæ›´æ–°** - æ»šåŠ¨æ›´æ–°ç­–ç•¥

---

ğŸš€ **é…ç½®å®Œæˆï¼ç°åœ¨æ¯å½“ä½ æ¨é€ä»£ç åˆ°mainåˆ†æ”¯ï¼Œåç«¯æœåŠ¡å°±ä¼šè‡ªåŠ¨éƒ¨ç½²åˆ°é˜¿é‡Œäº‘æœåŠ¡å™¨ã€‚**

ğŸ“ **è¯¦ç»†æ­¥éª¤è¯·å‚è€ƒ**: é˜¿é‡Œäº‘å¿«é€Ÿéƒ¨ç½².md