# GitHub Actions å·¥ä½œæµè§¦å‘æŒ‡å—

## ğŸ¯ å¦‚ä½•é€‰æ‹©å’Œè§¦å‘ç‰¹å®šå·¥ä½œæµ

### å½“å‰å¯ç”¨çš„å·¥ä½œæµ

1. **deploy-alicloud.yml** - é˜¿é‡Œäº‘æœåŠ¡å™¨Dockeréƒ¨ç½²
2. **simple-deploy.yml** - ç®€åŒ–éƒ¨ç½²å·¥ä½œæµï¼ˆå¤‡ç”¨ï¼‰
3. **deploy.yml** - é€šç”¨éƒ¨ç½²å·¥ä½œæµ

## ğŸš€ ä¸‰ç§è§¦å‘ deploy-alicloud.yml çš„æ–¹å¼

### æ–¹å¼1: ä¿®æ”¹serverç›®å½•æ–‡ä»¶ï¼ˆæœ€å¸¸ç”¨ï¼‰
```bash
# ä¿®æ”¹serverç›®å½•ä¸‹çš„ä»»ä½•æ–‡ä»¶éƒ½ä¼šè§¦å‘
echo "è§¦å‘deploy-alicloudå·¥ä½œæµ" >> server/test.txt
git add .
git commit -m "update: æµ‹è¯•è§¦å‘deploy-alicloud"
git push
```

**ç‰¹ç‚¹**: âœ… è‡ªåŠ¨è§¦å‘ï¼ŒğŸ”„ æ¯æ¬¡ä¿®æ”¹serverç›®å½•éƒ½æ‰§è¡Œ

### æ–¹å¼2: æ‰‹åŠ¨è§¦å‘ï¼ˆGitHubç½‘é¡µï¼‰
1. è®¿é—®ï¼šhttps://github.com/helloimcx/diancan-food-ordering/actions
2. ç‚¹å‡» "é˜¿é‡Œäº‘æœåŠ¡å™¨Dockeréƒ¨ç½²"
3. ç‚¹å‡» "Run workflow"
4. é€‰æ‹©åˆ†æ”¯ï¼š`main`
5. ç‚¹å‡»ç»¿è‰²çš„ "Run workflow" æŒ‰é’®

**ç‰¹ç‚¹**: âœ… å®Œå…¨æ‰‹åŠ¨æ§åˆ¶ï¼ŒğŸ”„ å¯éšæ—¶è§¦å‘

### æ–¹å¼3: ä¿®æ”¹è§¦å‘æ¡ä»¶ï¼ˆä¸´æ—¶ï¼‰
ä¸´æ—¶ä¿®æ”¹ `deploy-alicloud.yml` çš„è§¦å‘æ¡ä»¶ï¼š

```yaml
on:
  push:
    branches: [ main ]
  # åˆ é™¤æˆ–æ³¨é‡Š paths é™åˆ¶ï¼Œæ”¹ä¸ºï¼š
  # paths: ['server/**']  # æ³¨é‡Šè¿™ä¸€è¡Œ
  workflow_dispatch:    # å…è®¸æ‰‹åŠ¨è§¦å‘
```

## ğŸ“Š å·¥ä½œæµå¯¹æ¯”

| å·¥ä½œæµ | è§¦å‘æ¡ä»¶ | ç”¨é€” | æ¨èåœºæ™¯ |
|--------|----------|------|----------|
| **deploy-alicloud.yml** | æ¨é€mainåˆ†æ”¯ + ä¿®æ”¹server/** | é˜¿é‡Œäº‘Dockeréƒ¨ç½² | ç”Ÿäº§ç¯å¢ƒéƒ¨ç½² |
| **simple-deploy.yml** | æ¨é€mainåˆ†æ”¯ | å¤‡ç”¨éƒ¨ç½²æ–¹æ¡ˆ | æµ‹è¯•å’Œè°ƒè¯• |
| **deploy.yml** | æ¨é€mainåˆ†æ”¯ | é€šç”¨éƒ¨ç½² | å…¶ä»–å¹³å°éƒ¨ç½² |

## ğŸ”§ å¦‚ä½•åˆ‡æ¢å·¥ä½œæµ

### æ–¹æ¡ˆAï¼šä½¿ç”¨ paths ç²¾ç¡®æ§åˆ¶
```bash
# åªè§¦å‘deploy-alicloud
echo "ä¿®æ”¹åç«¯" >> server/database.js
git commit -am "update: ä¿®æ”¹åç«¯é€»è¾‘"

# è§¦å‘æ‰€æœ‰å·¥ä½œæµ
echo "ä¿®æ”¹å‰ç«¯" >> src/App.tsx
git commit -am "update: ä¿®æ”¹å‰ç«¯"
```

### æ–¹æ¡ˆBï¼šé‡å‘½åå·¥ä½œæµæ–‡ä»¶
```bash
# å¦‚æœæƒ³ä¼˜å…ˆä½¿ç”¨æŸä¸ªå·¥ä½œæµï¼Œå¯ä»¥é‡å‘½å
mv .github/workflows/deploy-alicloud.yml .github/workflows/1-deploy-alicloud.yml
mv .github/workflows/simple-deploy.yml .github/workflows/2-simple-deploy.yml
```

### æ–¹æ¡ˆCï¼šä½¿ç”¨ workflow_dispatch
åœ¨ `deploy-alicloud.yml` æ·»åŠ ï¼š
```yaml
on:
  push:
    branches: [ main ]
    paths: ['server/**']
  workflow_dispatch:    # å…è®¸æ‰‹åŠ¨è§¦å‘
```

## ğŸ¯ ç«‹å³è§¦å‘ deploy-alicloud çš„æ–¹æ³•

### æœ€ç®€å•çš„æ–¹æ³•ï¼ˆæ¨èï¼‰
```bash
# åœ¨serverç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªå°ä¿®æ”¹
touch server/.trigger-deploy
git add .
git commit -m "trigger: è§¦å‘é˜¿é‡Œäº‘éƒ¨ç½²å·¥ä½œæµ"
git push
```

### æˆ–è€…ä½¿ç”¨GitHubç½‘é¡µæ‰‹åŠ¨è§¦å‘
1. è¿›å…¥Actionsé¡µé¢
2. é€‰æ‹©"é˜¿é‡Œäº‘æœåŠ¡å™¨Dockeréƒ¨ç½²"
3. ç‚¹å‡»"Run workflow"

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å·¥ä½œæµåŒæ—¶è¿è¡Œ**: å¤šä¸ªå·¥ä½œæµå¯èƒ½åŒæ—¶è¿è¡Œ
2. **secretsé…ç½®**: ç¡®ä¿é˜¿é‡Œäº‘ç›¸å…³çš„secretså·²é…ç½®
3. **ç½‘ç»œé—®é¢˜**: å¦‚æœGitHub Actionsç½‘ç»œæœ‰é—®é¢˜ï¼Œå¯èƒ½éœ€è¦ä»£ç†
4. **æƒé™é—®é¢˜**: ç¡®ä¿ä»“åº“æœ‰å¿…è¦çš„æƒé™æ¨é€åˆ°å®¹å™¨æ³¨å†Œè¡¨

## ğŸš€ ç°åœ¨å°±è¯•è¯•

**ç«‹å³è§¦å‘ deploy-alicloud å·¥ä½œæµ**ï¼š
```bash
echo "æµ‹è¯•deploy-alicloudè§¦å‘" > server/.deployment-test
git add . && git commit -m "trigger: æµ‹è¯•deploy-alicloudå·¥ä½œæµ" && git push
```

ç„¶åè®¿é—®ï¼šhttps://github.com/helloimcx/diancan-food-ordering/actions æŸ¥çœ‹æ‰§è¡Œç»“æœï¼